<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>matrix.js</title>
  <link rel="stylesheet" href="../../pycco.css">
  <script type="text/javascript"
     src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>matrix.js</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>This file is part of the jsphys web physics package.<br />
Copyright (C) 2012 Matthew Watson<br />
@fileoverview 3d and 4d linear algebra library.</p>
<p>Use with care, there are no checks on anything because it needs to be fast.
Empirical testing  as of early 2012 showed objects to be faster than arrays for
some purposes, although I suspect this may change when firefox finish their
compiler overhaul.<br />
This is also partially a self-control measure as it discourages
frequent direct component access where a more abstract operation would be 
preferable.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>These functions were Intended for numbers but many work with string elements
  Most funcitons return the destination variable as well as requiring you to
  provide one (to avoid unnecessary if statements).
  As such they can either be used in a more imperative style</p>
<pre><code>var A = vec3.create(1,2,3),
    B = vec3.create(1,2,3),
    C = {};
vec3.add(A, B, C);
</code></pre>
<p>Or in a more functional style</p>
<pre><code>var A = vec3.create(1,2,3),
    B = vec3.create(1,2,3),
    C = vec3.add(A, B, {});
</code></pre>
<p>Using in a functional style every time</p>
<pre><code>C = vec3.add(A, B, C);
</code></pre>
<p>Is fine, but a bit redundant due to the requirement of providing a 
  destination.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <h2>vec3</h2>
<p>Functions for 3 element vectors consisting of an object with members x, y, z
  as in:</p>
<pre><code>X = {x: 1, y: 2, z: 3};
</code></pre>
<p>Allowed to contain other elements such as being a vec4.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kd">var</span> <span class="nx">vec3</span> <span class="o">=</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <h3>vec3.create</h3>
<p>Usage:</p>
<pre><code>var X = vec3.create(1,2,3);
</code></pre>
<p>Somewhat redundant as it's equivalent to:</p>
<pre><code>var X = vec3.setScalar(1,2,3,{});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">z</span><span class="p">};</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h3>vec3.setVec</h3>
<p>Usage:</p>
<pre><code>B = vec3.setVec(A,B);
vec3.setVec(A,B);
var B = vec3.setVec(A,{});
</code></pre>
<p>Set one vector from another. Or create one using an object literal
  as the destination.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">setVec</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <h3>vec3.setArr</h3>
<p>Set a vector from an array. Can also be used for creation.</p>
<pre><code>var A = vec3.setArr([1,2,3],{});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">setArr</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <h3>vec3.set</h3>
<p>Set vector from components.</p>
<pre><code>vec3.set(x,y,z, A);
var A = vec3.set(x,y,z, {});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <h3>vec3.add</h3>
<p>Add two vectors.
  $$\mathbf{C} = \mathbf{A} + \mathbf{B}$$</p>
<pre><code>vec3.add(A, B, C);
var C = vec3.add(A, B, {});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">add</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span> <span class="o">+</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <h3>vec3.subtract</h3>
<p>subtract two vectors.
  $$\mathbf{c} = \mathbf{a} - \mathbf{b}$$</p>
<pre><code>vec3.subtract(a, b, c);
var c = vec3.subtract(a, b, {});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">subtract</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span> <span class="o">-</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <h3>vec3.norm</h3>
<p>Normalize a vector.
  $$B=\frac{A}{|A|}$$</p>
<pre><code>vec3.norm(A, B);
var B = vec3.norm(A, {});
</code></pre>
<p>$$\frac{A}{|A|} = 1$$</p>
<pre><code>vec3.norm(A,A);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">norm</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">z</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span>
        <span class="nx">imag</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">z</span> <span class="o">*</span> <span class="nx">z</span><span class="p">);</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">imag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">*</span> <span class="nx">imag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">z</span> <span class="o">*</span> <span class="nx">imag</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <h3>vec3.cross</h3>
<p>Cross product. If you use it on a vec4 you'll get nonsense.
  $$ \mathbf{C} = \mathbf{A}\times\mathbf{B}$$</p>
<pre><code>vec3.cross(A, B, C);
var C = vec3.cross(A, B, {});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">cross</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">x1</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">x2</span> <span class="o">=</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">y1</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">y2</span> <span class="o">=</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">z1</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span> <span class="nx">z2</span> <span class="o">=</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">y1</span> <span class="o">*</span> <span class="nx">z2</span> <span class="o">-</span> <span class="nx">z1</span> <span class="o">*</span> <span class="nx">y2</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">z1</span> <span class="o">*</span> <span class="nx">x2</span> <span class="o">-</span> <span class="nx">x1</span> <span class="o">*</span> <span class="nx">z2</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">x1</span> <span class="o">*</span> <span class="nx">y2</span> <span class="o">-</span> <span class="nx">y1</span> <span class="o">*</span> <span class="nx">x2</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <h3>vec3.dot</h3>
<p>Dot product between two vectors.
  $$c = \mathbf{A}\cdot\mathbf{B}$$</p>
<pre><code>var c = vec3.dot(A,B);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">dot</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span>
           <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span>
           <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <h3>vec3.scale</h3>
<p>Scale a vector by a constant.
  $$\mathbf{B} = a\mathbf{A}$$</p>
<pre><code>var a = 5,
    A = vec3.create(1,2,3);
B = vec3.scale(a,A, {});
vec3.scale{2, A, A};
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">scale</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">scale</span><span class="p">,</span> <span class="nx">vec</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <h2>mat3</h2>
<p>Functions for 3x3 element matrices of format:</p>
<pre><code>A = {aa: aa, ab: ab, ac: ac,
     ba: ba, bb: bb, bc: bc,
     ca: ca, cb: cb, cc: cc}
</code></pre>
<p>First letter is column, second is row.
  $$\begin{pmatrix}aa&amp;ab&amp;ac\\
                   ba&amp;bb&amp;bc\\
                   ca&amp;cb&amp;cc
  \end{pmatrix}$$</p>
<p>Any vec3 is assumed to be column vectors unless mentioned.
  Default multiplication is with the matrix on the left.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kd">var</span> <span class="nx">mat3</span> <span class="o">=</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <h3>mat3.create</h3>
<p>Usage:</p>
<pre><code>var A = vec3.create(1,2,3,4,5,6,7,8,9);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">aa</span><span class="p">,</span> <span class="nx">ab</span><span class="p">,</span> <span class="nx">ac</span><span class="p">,</span> <span class="nx">ba</span><span class="p">,</span> <span class="nx">bb</span><span class="p">,</span> <span class="nx">bc</span><span class="p">,</span> <span class="nx">ca</span><span class="p">,</span> <span class="nx">cb</span><span class="p">,</span> <span class="nx">cc</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">aa</span><span class="o">:</span> <span class="nx">aa</span><span class="p">,</span> <span class="nx">ab</span><span class="o">:</span> <span class="nx">ab</span><span class="p">,</span> <span class="nx">ac</span><span class="o">:</span> <span class="nx">ac</span><span class="p">,</span>
      <span class="nx">ba</span><span class="o">:</span> <span class="nx">ba</span><span class="p">,</span> <span class="nx">bb</span><span class="o">:</span> <span class="nx">bb</span><span class="p">,</span> <span class="nx">bc</span><span class="o">:</span> <span class="nx">bc</span><span class="p">,</span>
      <span class="nx">ca</span><span class="o">:</span> <span class="nx">ca</span><span class="p">,</span> <span class="nx">cb</span><span class="o">:</span> <span class="nx">cb</span><span class="p">,</span> <span class="nx">cc</span><span class="o">:</span> <span class="nx">cc</span>
    <span class="p">};</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <h3>mat3.set</h3>
<p>Usage:</p>
<pre><code>var A = vec3.create(1,2,3,4,5,6,7,8,9, {});
</code></pre>
<p>Alternate:</p>
<pre><code>vec3.create(1,2,3,4,5,6,7,8,9, A);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">aa</span><span class="p">,</span> <span class="nx">ab</span><span class="p">,</span> <span class="nx">ac</span><span class="p">,</span> <span class="nx">ba</span><span class="p">,</span> <span class="nx">bb</span><span class="p">,</span> <span class="nx">bc</span><span class="p">,</span> <span class="nx">ca</span><span class="p">,</span> <span class="nx">cb</span><span class="p">,</span> <span class="nx">cc</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">dest</span><span class="p">.</span><span class="nx">aa</span> <span class="o">=</span> <span class="nx">aa</span><span class="p">;</span>
      <span class="nx">dest</span><span class="p">.</span><span class="nx">ab</span> <span class="o">=</span> <span class="nx">ab</span><span class="p">;</span>
      <span class="nx">dest</span><span class="p">.</span><span class="nx">ac</span> <span class="o">=</span> <span class="nx">ac</span><span class="p">;</span>

      <span class="nx">dest</span><span class="p">.</span><span class="nx">ba</span> <span class="o">=</span> <span class="nx">ba</span><span class="p">;</span>
      <span class="nx">dest</span><span class="p">.</span><span class="nx">bb</span> <span class="o">=</span> <span class="nx">bb</span><span class="p">;</span>
      <span class="nx">dest</span><span class="p">.</span><span class="nx">bc</span> <span class="o">=</span> <span class="nx">bc</span><span class="p">;</span>

      <span class="nx">dest</span><span class="p">.</span><span class="nx">ca</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">;</span>
      <span class="nx">dest</span><span class="p">.</span><span class="nx">cb</span> <span class="o">=</span> <span class="nx">cb</span><span class="p">;</span>
      <span class="nx">dest</span><span class="p">.</span><span class="nx">cc</span> <span class="o">=</span> <span class="nx">cc</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <h3>mat3.mulVec3</h3>
<p>Multiply a vec3 by a mat3 on the left putting the result into a vec3.
$$\mathbf{U} = A\mathbf{V}$$</p>
<pre><code>U = mat3.mulVec3(A, V, {});
</code></pre>
<p>Or:</p>
<pre><code>mat3.mulVec3(A, V, U);
</code></pre>
<p>Or with an implicit 1 if dest is the same as the input and a vec4:
$$\begin{pmatrix}1&amp; 0&amp; 0&amp; 0\\
               0&amp;aa&amp;ab&amp;ac\\
               0&amp;ba&amp;bb&amp;bc\\
               0&amp;ca&amp;cb&amp;cc\end{pmatrix}
\begin{pmatrix}t\\x\\y\\z\end{pmatrix}$$</p>
<pre><code>mat3.mulVec3(mat3, U, U);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">mulVec3</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span> <span class="nx">vec3</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">vec3</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">vec3</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">z</span> <span class="o">=</span> <span class="nx">vec3</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">z</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">z</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">z</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <h3>mat3.mul</h3>
<p>Multiply two 3x3 matrices.
Empirical testing showed caching was detrimental on recent browsers.
  $$\begin{pmatrix}aa&amp;ab&amp;ac\\
                   ba&amp;bb&amp;bc\\
                   ca&amp;cb&amp;cc\end{pmatrix}
    \begin{pmatrix}aa&amp;ab&amp;ac\\
                   ba&amp;bb&amp;bc\\
                   ca&amp;cb&amp;cc\end{pmatrix}$$
Usage:</p>
<pre><code>C = mat3.mul(A,B,{});
mat3.mul(A,B,C);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">mul</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">m1</span><span class="p">,</span> <span class="nx">m2</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">aa</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">aa</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ba</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ca</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">ab</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ab</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">bb</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">cb</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">ac</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ac</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">bc</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">cc</span><span class="p">;</span>

    <span class="nx">dest</span><span class="p">.</span><span class="nx">ba</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">aa</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ba</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ca</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">bb</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ab</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">bb</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">cb</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">bc</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ac</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">bc</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">cc</span><span class="p">;</span>

    <span class="nx">dest</span><span class="p">.</span><span class="nx">ca</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">aa</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ba</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ca</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">cb</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ab</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">bb</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">cb</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">cc</span> <span class="o">=</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">ac</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">bc</span> <span class="o">+</span> <span class="nx">m1</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">m2</span><span class="p">.</span><span class="nx">cc</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <h3>mat3.vecToRows</h3>
<p>Make a matrix with rows consisting of vec3s (or the x,y,z components of
vec4s.
Useful for producing a transformation from a set of basis vectors.
Usage:</p>
<pre><code>T = mat3.vecToRows(X,Y,Z,{});
mat3.vecToRows(X, Y, Z, T);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">vecToRows</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">,</span> <span class="nx">vec3</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">aa</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">ab</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">ac</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>

    <span class="nx">dest</span><span class="p">.</span><span class="nx">ba</span> <span class="o">=</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">bb</span> <span class="o">=</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">bc</span> <span class="o">=</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>

    <span class="nx">dest</span><span class="p">.</span><span class="nx">ca</span> <span class="o">=</span> <span class="nx">vec3</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">cb</span> <span class="o">=</span> <span class="nx">vec3</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">cc</span> <span class="o">=</span> <span class="nx">vec3</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>


<span class="kd">var</span> <span class="nx">vec4</span> <span class="o">=</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <h3>vec4.create</h3>
<p>Usage:</p>
<pre><code>var X = vec3.create(1,2,3,4);
</code></pre>
<p>Somewhat redundant as it's equivalent to:</p>
<pre><code>var X = vec3.setScalar(1,2,3,4,{});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">,</span> <span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="nx">z</span><span class="p">,</span> <span class="nx">t</span><span class="o">:</span> <span class="nx">t</span><span class="p">};</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <h3>vec4.setVec</h3>
<p>Usage:</p>
<pre><code>B = vec3.setVec(A,B);
vec3.setVec(A,B);
var B = vec3.setVec(A,{});
</code></pre>
<p>Set one vector from another. Or create one using an object literal
  as the destination.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">setVec</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">t</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <h3>vec4.set</h3>
<p>Set vector from components.</p>
<pre><code>vec4.set(1,2,3,4, B);
var B = vec3.set(1,2,3,4, {});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">z</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">t</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <h3>vec4.add</h3>
<p>Add two vectors.
  $$\mathbf{C} = \mathbf{A} + \mathbf{B}$$</p>
<pre><code>vec4.add(A, B, C);
var C = vec4.add(A, B, {});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">add</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span> <span class="o">+</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">t</span> <span class="o">+</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">t</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <h3>vec4.subtract</h3>
<p>Subtract two vectors.
  $$\mathbf{C} = \mathbf{A} - \mathbf{B}$$</p>
<pre><code>vec4.subtract(A, B, C);
var C = vec4.subtract(A, B, {});
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">subtract</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span> <span class="o">-</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <h3>vec4.norm</h3>
<p>Normalize a vector. With 4D Euclidean norm.
  $$B=\frac{A}{|A|}$$</p>
<pre><code>vec4.norm(A, B);
var B = vec4.norm(A, {});
</code></pre>
<p>$$\frac{A}{|A|} = 1$$</p>
<pre><code>vec4.norm(A,A);
</code></pre>
<p>Returns a vector of 0s if the magnitude is 0.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">norm</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">mag</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">z</span> <span class="o">*</span> <span class="nx">z</span> <span class="o">+</span> <span class="nx">t</span> <span class="o">*</span> <span class="nx">t</span><span class="p">);</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>Return 0 vector if mag is null.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">mag</span> <span class="o">=</span> <span class="nx">mag</span> <span class="o">?</span> <span class="mi">1</span><span class="o">/</span><span class="nx">mag</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">t</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <h3>vec4.spaceNorm</h3>
<p>Normalize a 4D vector. With 3D euclidean norm.
  $$A = \begin{pmatrix}t\\x\\y\\z\end{pmatrix}$$
  $$a=\sqrt{x^2 + y^2 + z^2}$$
  $$B=\frac{A}{a}$$</p>
<pre><code>vec4.norm(A, B);
var B = vec4.norm(A, {});
</code></pre>
<p>$$\frac{A}{a} = 1$$</p>
<pre><code>vec4.norm(A,A);
</code></pre>
<p>Returns a vector of 0s if the magnitude is 0.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">spaceNorm</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">mag</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">z</span> <span class="o">*</span> <span class="nx">z</span><span class="p">);</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Return 0 vector if mag is null.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">mag</span> <span class="o">=</span> <span class="nx">mag</span> <span class="o">?</span> <span class="mi">1</span><span class="o">/</span><span class="nx">mag</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">t</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <h3>vec4.stNorm</h3>
<p>Normalize a vector. With 4D Minkowski norm.
  $$B=\frac{A}{|A|}$$</p>
<pre><code>vec4.norm(A, B);
var B = vec4.norm(A, {});
</code></pre>
<p>$$\frac{A}{|A|} = 1$$</p>
<pre><code>vec4.norm(A,A);
</code></pre>
<p>Returns a null vector with t component 1 if the magnitude is 0.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">stNorm</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">mag</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">z</span> <span class="o">*</span> <span class="nx">z</span> <span class="o">-</span> <span class="nx">t</span> <span class="o">*</span> <span class="nx">t</span><span class="p">);</span>
    <span class="nx">mag</span> <span class="o">=</span> <span class="nx">mag</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">mag</span> <span class="o">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">t</span><span class="p">;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>If the vector is null, normalise it so t component == 1.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">t</span> <span class="o">*</span> <span class="nx">mag</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <h3>vec4.dot</h3>
<p>4D Euclidean inner product between two vectors.
  $$c = \mathbf{A}\cdot\mathbf{B} = 
  A_tB_t + A_xB_x + A_yB_y + A_zB_z$$</p>
<pre><code>var c = vec4.dot(A,B);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">dot</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">t</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">t</span> <span class="o">+</span>
           <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span>
           <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span>
           <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <h3>vec4.spaceDot</h3>
<p>Spatial magnitude. Good for distances.
$$\begin{pmatrix}A_t&amp;A_x&amp;A_y&amp;A_z\end{pmatrix}
\begin{pmatrix}0&amp;0&amp;0&amp;0\\
               0&amp;1&amp;0&amp;0\\
               0&amp;0&amp;1&amp;0\\
               0&amp;0&amp;0&amp;1\end{pmatrix}
\begin{pmatrix}B_t\\B_x\\B_y\\B_z\end{pmatrix}$$
Usage:</p>
<pre><code>r = spaceDot(A,B);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">spaceDot</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span>
           <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span>
           <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <h3>vec4.stDot</h3>
<p>1+3D Minkowski inner product between two vectors.
  $$c = \mathbf{A}\cdot\mathbf{B} = 
  -A_tB_t + A_xB_x + A_yB_y + A_zB_z$$</p>
<pre><code>var c = vec4.stDot(A,B);
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">stDot</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec1</span><span class="p">,</span> <span class="nx">vec2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">-</span><span class="nx">vec1</span><span class="p">.</span><span class="nx">t</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">t</span> <span class="o">+</span> 
            <span class="nx">vec1</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span>
            <span class="nx">vec1</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span>
            <span class="nx">vec1</span><span class="p">.</span><span class="nx">z</span> <span class="o">*</span> <span class="nx">vec2</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <h3>vec4.scale</h3>
<p>Scale a vector by a constant.
  $$\mathbf{B} = a\mathbf{A}$$</p>
<pre><code>var a = 5,
    A = vec4.create(1,2,3);
B = vec4.scale(a,A, {});
vec4.scale{2, A, A};
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">scale</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec</span><span class="p">,</span> <span class="nx">scale</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">vec</span><span class="p">.</span><span class="nx">t</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <h3>vec4.toLat</h3>
<p>Projuce latex formatted output with optional type.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">toLat</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">vec</span><span class="p">,</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">type</span> <span class="o">=</span> <span class="nx">type</span> <span class="o">||</span> <span class="s1">&#39;pmatrix&#39;</span><span class="p">;</span>
    <span class="k">return</span> <span class="s1">&#39;\\[\\begin{&#39;</span><span class="o">+</span><span class="nx">type</span><span class="o">+</span><span class="s1">&#39;}&#39;</span> <span class="o">+</span>
           <span class="nx">vec</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="s1">&#39; \\\\\n&#39;</span> <span class="o">+</span> 
           <span class="nx">vec</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="s1">&#39; \\\\\n&#39;</span> <span class="o">+</span> 
           <span class="nx">vec</span><span class="p">.</span><span class="nx">z</span> <span class="o">+</span> <span class="s1">&#39; \\\\\n&#39;</span> <span class="o">+</span> 
           <span class="nx">vec</span><span class="p">.</span><span class="nx">t</span> <span class="o">+</span> <span class="s1">&#39; \\end{&#39;</span><span class="o">+</span><span class="nx">type</span><span class="o">+</span><span class="s1">&#39;}\\]&#39;</span><span class="p">;</span> 
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">mat4</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">aa</span><span class="p">,</span> <span class="nx">ab</span><span class="p">,</span> <span class="nx">ac</span><span class="p">,</span> <span class="nx">ad</span><span class="p">,</span>
                   <span class="nx">ba</span><span class="p">,</span> <span class="nx">bb</span><span class="p">,</span> <span class="nx">bc</span><span class="p">,</span> <span class="nx">bd</span><span class="p">,</span>
                   <span class="nx">ca</span><span class="p">,</span> <span class="nx">cb</span><span class="p">,</span> <span class="nx">cc</span><span class="p">,</span> <span class="nx">cd</span><span class="p">,</span>
                   <span class="nx">da</span><span class="p">,</span> <span class="nx">db</span><span class="p">,</span> <span class="nx">dc</span><span class="p">,</span> <span class="nx">dd</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">aa</span><span class="o">:</span> <span class="nx">aa</span><span class="p">,</span> <span class="nx">ab</span><span class="o">:</span> <span class="nx">ab</span><span class="p">,</span> <span class="nx">ac</span><span class="o">:</span> <span class="nx">ac</span><span class="p">,</span> <span class="nx">ad</span><span class="o">:</span> <span class="nx">ad</span><span class="p">,</span>
      <span class="nx">ba</span><span class="o">:</span> <span class="nx">ba</span><span class="p">,</span> <span class="nx">bb</span><span class="o">:</span> <span class="nx">bb</span><span class="p">,</span> <span class="nx">bc</span><span class="o">:</span> <span class="nx">bc</span><span class="p">,</span> <span class="nx">bd</span><span class="o">:</span> <span class="nx">bd</span><span class="p">,</span>
      <span class="nx">ca</span><span class="o">:</span> <span class="nx">ca</span><span class="p">,</span> <span class="nx">cb</span><span class="o">:</span> <span class="nx">cb</span><span class="p">,</span> <span class="nx">cc</span><span class="o">:</span> <span class="nx">cc</span><span class="p">,</span> <span class="nx">cd</span><span class="o">:</span> <span class="nx">cd</span><span class="p">,</span>
      <span class="nx">da</span><span class="o">:</span> <span class="nx">da</span><span class="p">,</span> <span class="nx">db</span><span class="o">:</span> <span class="nx">db</span><span class="p">,</span> <span class="nx">dc</span><span class="o">:</span> <span class="nx">dc</span><span class="p">,</span> <span class="nx">dd</span><span class="o">:</span> <span class="nx">dd</span>
    <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">mulVec4</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">vec4</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">vec4</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">vec4</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">z</span> <span class="o">=</span> <span class="nx">vec4</span><span class="p">.</span><span class="nx">z</span><span class="p">,</span>
        <span class="nx">t</span> <span class="o">=</span> <span class="nx">vec4</span><span class="p">.</span><span class="nx">t</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">z</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ad</span> <span class="o">*</span> <span class="nx">t</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">z</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bd</span> <span class="o">*</span> <span class="nx">t</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">z</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cd</span> <span class="o">*</span> <span class="nx">t</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">da</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">db</span> <span class="o">*</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dc</span> <span class="o">*</span> <span class="nx">z</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dd</span> <span class="o">*</span> <span class="nx">t</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">mul</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Yuck.
Multiply AB as below:</p>
<p>/aa ab ac ad\  /aa ab ac ad\
| ba bb bc bd || ba bb bc bd |
| ca cb cc cd || ca cb cc cd |
 \da db dc dd/  \da db dc dd/</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">dest</span><span class="p">.</span><span class="nx">aa</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">aa</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ba</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ca</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ad</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">da</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">ab</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ab</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bb</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cb</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ad</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">db</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">ac</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ac</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bc</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cc</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ad</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">dc</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">ad</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">aa</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ad</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ab</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bd</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ac</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cd</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ad</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">dd</span><span class="p">;</span>

    <span class="nx">dest</span><span class="p">.</span><span class="nx">ba</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">aa</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ba</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ca</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">da</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">bb</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ab</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bb</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cb</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">db</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">bc</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ac</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bc</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cc</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">dc</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">bd</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ba</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ad</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bb</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bd</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cd</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">dd</span><span class="p">;</span>

    <span class="nx">dest</span><span class="p">.</span><span class="nx">ca</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">aa</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ba</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ca</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">da</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">cb</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ab</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bb</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cb</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">db</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">cc</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ac</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bc</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cc</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">dc</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">cd</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ca</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ad</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cb</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bd</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cd</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">dd</span><span class="p">;</span>

    <span class="nx">dest</span><span class="p">.</span><span class="nx">da</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">da</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">aa</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">db</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ba</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ca</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">da</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">db</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">da</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ab</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">db</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bb</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cb</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">db</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">dc</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">da</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ac</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">db</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bc</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cc</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">dc</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">dd</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">da</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">ad</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">db</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">bd</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dc</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">cd</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dd</span> <span class="o">*</span> <span class="nx">B</span><span class="p">.</span><span class="nx">dd</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <h3>mat4.textMul</h3>
<p>Some very simple symbolic manipulation, assuming input is a string and
outputting a string.
Nobody is quite sure why this happened.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">textMul</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">,</span> <span class="nx">dest</span><span class="p">,</span> <span class="nx">timesChar</span><span class="p">,</span> <span class="nx">plusChar</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">timesChar</span> <span class="o">||</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span>
        <span class="nx">p</span> <span class="o">=</span> <span class="nx">plusChar</span> <span class="o">||</span> <span class="s1">&#39;+&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s1">&#39;abcd&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">zero</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cur</span><span class="p">,</span><span class="nx">prev</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">)){</span>
      <span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">j</span><span class="p">)){</span>
        <span class="nx">dest</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span><span class="p">;</span>
        <span class="nx">prev</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">a</span><span class="p">){</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">k</span><span class="p">)){</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>Nobody likes you, jslint; it's a string
Also what if I <em>want</em> to coerce comparison to 0?</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>If we have no term, set it to '' else, combine two components w a
timesChar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>          <span class="nx">b</span> <span class="o">=</span> <span class="nx">A</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">k</span><span class="p">]];</span>
          <span class="nx">c</span> <span class="o">=</span> <span class="nx">B</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]];</span>
          <span class="nx">cur</span> <span class="o">=</span> <span class="p">(</span><span class="nx">b</span> <span class="o">==</span> <span class="nx">zero</span> <span class="o">||</span> <span class="nx">c</span> <span class="o">==</span> <span class="nx">zero</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span>
           <span class="p">(</span><span class="nx">b</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;1&#39;</span> <span class="o">:</span> <span class="p">((</span><span class="nx">b</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nx">b</span><span class="p">)</span> <span class="o">+</span><span class="nx">t</span><span class="o">+</span> <span class="p">(</span><span class="nx">c</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nx">c</span><span class="p">));</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>If it's time for a plusChar, give us a plusChar. Append current
term to current element.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>          <span class="nx">dest</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">+=</span> <span class="p">((</span><span class="nx">prev</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">cur</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">?</span> <span class="nx">p</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="o">+</span> <span class="nx">cur</span><span class="p">;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>If we have a non '' term, make it the reference term for plusChar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>          <span class="nx">prev</span> <span class="o">=</span> <span class="p">(</span><span class="nx">cur</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">prev</span> <span class="o">:</span> <span class="nx">cur</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>If we didn't generate anything, bung in a 0.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">dest</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">+=</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
        <span class="nx">dest</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">dest</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">===</span> <span class="s1">&#39;()&#39;</span> <span class="o">?</span> <span class="s1">&#39; 0 &#39;</span><span class="o">:</span> 
        <span class="nx">dest</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">===</span> <span class="s1">&#39;(1)&#39;</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="nx">dest</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]];</span>
      <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <h3>mat4.toText</h3>
<p>Take a mat4 with numbers and output one with either fixed precision or fixed
place decimal strings.
Usage:</p>
<pre><code>mat4.toText(a, 4, true); // Outputs 0.xxxx
mat4.toText(a, 3, false); // Outputs 3 sig figs.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">toText</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">prec</span><span class="p">,</span> <span class="nx">fixed</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">dest</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">el</span> <span class="k">in</span> <span class="nx">A</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">el</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">dest</span><span class="p">[</span><span class="nx">el</span><span class="p">]</span> <span class="o">=</span> <span class="nx">A</span><span class="p">[</span><span class="nx">el</span><span class="p">]</span> <span class="o">?</span> <span class="p">(</span><span class="nx">fixed</span> <span class="o">?</span> <span class="nx">A</span><span class="p">[</span><span class="nx">el</span><span class="p">].</span><span class="nx">toFixed</span><span class="p">(</span><span class="nx">prec</span><span class="p">)</span> <span class="o">:</span> 
                                    <span class="nx">A</span><span class="p">[</span><span class="nx">el</span><span class="p">].</span><span class="nx">toPrecision</span><span class="p">(</span><span class="nx">prec</span><span class="p">))</span> <span class="o">:</span>
                           <span class="s1">&#39; 0 &#39;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <h3>mat4.toArr</h3>
<p>Take {aa,...dd} formatted matrix and return 16 element vector with same
elements.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">toArr</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">aa</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">ab</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">ac</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">ad</span><span class="p">,</span>
            <span class="nx">A</span><span class="p">.</span><span class="nx">ba</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">bb</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">bc</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">bd</span><span class="p">,</span>
            <span class="nx">A</span><span class="p">.</span><span class="nx">ca</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">cb</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">cc</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">cd</span><span class="p">,</span>
            <span class="nx">A</span><span class="p">.</span><span class="nx">da</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">db</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">dc</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">dd</span><span class="p">];</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <h3>mat4.toArr2</h3>
<p>Take {aa,...dd} formatted matrix and return 4 element vector with elements
of 4 element vectors with same elements.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">toArr2</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[[</span><span class="nx">A</span><span class="p">.</span><span class="nx">aa</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">ab</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">ac</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">ad</span><span class="p">],</span>
            <span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">ba</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">bb</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">bc</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">bd</span><span class="p">],</span>
            <span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">ca</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">cb</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">cc</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">cd</span><span class="p">],</span>
            <span class="p">[</span><span class="nx">A</span><span class="p">.</span><span class="nx">da</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">db</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">dc</span><span class="p">,</span><span class="nx">A</span><span class="p">.</span><span class="nx">dd</span><span class="p">]];</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <h3>mat4.fromArr</h3>
<p>Same as mat4.toArr in reverse.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">fromArr</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ar</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">mat4</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">ar</span><span class="p">[</span> <span class="mi">0</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span> <span class="mi">1</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span> <span class="mi">2</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span> <span class="mi">3</span><span class="p">],</span>
                       <span class="nx">ar</span><span class="p">[</span> <span class="mi">4</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span> <span class="mi">5</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span> <span class="mi">6</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span> <span class="mi">7</span><span class="p">],</span>
                       <span class="nx">ar</span><span class="p">[</span> <span class="mi">8</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span> <span class="mi">9</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
                       <span class="nx">ar</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">15</span><span class="p">]);</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <h3>mat4.fromArr2</h3>
<p>Same as mat4.toArr2 in reverse.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">fromArr2</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ar</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">mat4</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">ar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                       <span class="nx">ar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                       <span class="nx">ar</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                       <span class="nx">ar</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="nx">ar</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]);</span>
  <span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <h3>mat4.toLat</h3>
<p>Take matrix and return latex formatted string with optional type.
Type is anything that fits foo in \begin{foo} and accepts row/column input.
ie. pmatrix bmatrix etc.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="nx">toLat</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">type</span> <span class="o">=</span> <span class="nx">type</span> <span class="o">||</span> <span class="s1">&#39;pmatrix&#39;</span><span class="p">;</span>
    <span class="k">return</span> <span class="s1">&#39;\\[\\begin{&#39;</span><span class="o">+</span><span class="nx">type</span><span class="o">+</span><span class="s1">&#39;}&#39;</span> <span class="o">+</span>
           <span class="nx">A</span><span class="p">.</span><span class="nx">aa</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ab</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ac</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">ad</span> <span class="o">+</span> <span class="s1">&#39; \\\\\n&#39;</span> <span class="o">+</span> 
           <span class="nx">A</span><span class="p">.</span><span class="nx">ba</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bb</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bc</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">bd</span> <span class="o">+</span> <span class="s1">&#39; \\\\\n&#39;</span> <span class="o">+</span> 
           <span class="nx">A</span><span class="p">.</span><span class="nx">ca</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cb</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cc</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">cd</span> <span class="o">+</span> <span class="s1">&#39; \\\\\n&#39;</span> <span class="o">+</span> 
           <span class="nx">A</span><span class="p">.</span><span class="nx">da</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">db</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dc</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">A</span><span class="p">.</span><span class="nx">dd</span> <span class="o">+</span> <span class="s1">&#39; \\end{&#39;</span><span class="o">+</span><span class="nx">type</span><span class="o">+</span><span class="s1">&#39;}\\]&#39;</span><span class="p">;</span> 
  <span class="p">}</span>
<span class="p">};</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <h2>mat</h2>
<p>General purpose matrix functions.
Let's see if all that retardedness was worth it.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">mat</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">h</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">arr</span> <span class="o">=</span> <span class="nx">arr</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="nx">w</span> <span class="o">=</span> <span class="nx">w</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">h</span> <span class="o">=</span> <span class="nx">h</span> <span class="o">||</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">h</span><span class="o">*</span><span class="nx">w</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">arr</span> <span class="o">&amp;&amp;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">len</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">len</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="p">{</span><span class="nx">h</span> <span class="o">:</span> <span class="nx">h</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">arr</span><span class="o">:</span> <span class="nx">arr</span><span class="p">,</span> <span class="nx">len</span><span class="o">:</span> <span class="nx">len</span><span class="p">};</span>
      <span class="k">return</span> <span class="nx">A</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">arr</span><span class="p">,</span> <span class="nx">h</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">h</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">w</span> <span class="o">=</span> <span class="nx">w</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">h</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="nx">w</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">A</span><span class="p">.</span><span class="nx">h</span> <span class="o">=</span> <span class="nx">h</span><span class="p">;</span>
    <span class="nx">A</span><span class="p">.</span><span class="nx">w</span> <span class="o">=</span> <span class="nx">w</span><span class="p">;</span>
    <span class="nx">A</span><span class="p">.</span><span class="nx">len</span> <span class="o">=</span> <span class="nx">h</span><span class="o">*</span><span class="nx">w</span><span class="p">;</span>
    <span class="nx">A</span><span class="p">.</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">len</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="nx">ii</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">len</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">iArr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">A</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">mul</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">,</span> <span class="nx">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span>
        <span class="nx">h</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">h</span><span class="p">,</span>
        <span class="nx">w</span> <span class="o">=</span> <span class="nx">B</span><span class="p">.</span><span class="nx">w</span><span class="p">,</span>
        <span class="nx">kk</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">w</span><span class="p">,</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">h</span><span class="o">*</span><span class="nx">w</span><span class="p">,</span>
        <span class="nx">Aa</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">arr</span><span class="p">,</span>
        <span class="nx">Ba</span> <span class="o">=</span> <span class="nx">B</span><span class="p">.</span><span class="nx">arr</span><span class="p">,</span>
        <span class="nx">arr</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">h</span> <span class="o">=</span> <span class="nx">h</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">w</span> <span class="o">=</span> <span class="nx">w</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">len</span> <span class="o">=</span> <span class="nx">len</span><span class="p">;</span>
    <span class="nx">arr</span> <span class="o">=</span> <span class="nx">dest</span><span class="p">.</span><span class="nx">arr</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">len</span><span class="p">;</span>
    <span class="nx">dest</span><span class="p">.</span><span class="nx">arr</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">h</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">c</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">h</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">jj</span> <span class="o">=</span> <span class="nx">w</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">jj</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="nx">kk</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">t</span> <span class="o">+=</span> <span class="nx">Aa</span><span class="p">[</span><span class="nx">c</span><span class="o">+</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">Ba</span><span class="p">[</span><span class="nx">j</span><span class="o">+</span><span class="nx">h</span><span class="o">*</span><span class="nx">k</span><span class="p">];</span>
        <span class="p">}</span>
      <span class="nx">arr</span><span class="p">[</span><span class="nx">c</span><span class="o">+</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">t</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="nb">window</span><span class="p">[</span><span class="s1">&#39;vec3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vec3</span><span class="p">;</span>
<span class="nb">window</span><span class="p">[</span><span class="s1">&#39;mat3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">mat3</span><span class="p">;</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
