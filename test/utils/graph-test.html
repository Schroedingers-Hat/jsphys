<!DOCTYPE html>
<html>
    <head>
        <title>Feature test for graph module.</title>
        <script src="/js/extern/jquery/jquery.js"></script>
        <script type="text/javascript" src="/js/maths/matrix.js"></script>
        <script type="text/javascript" src="/js/utils/graph.js"></script>
        <script type="text/javascript" src="/js/lib/ui.js"></script>
    </head>

    <body>
      Mouseover me!
      <div id='mygraph'></div>
      Click me!
      <div id='another'></div>
      Mouseover me!
      <div id='points'></div>
      Click me!
      <div id='morePoints'></div>
      One dragging method.
      <div id='draggy'></div>
      Another dragging method
      <div id='panny'></div>
      <script>
        var g1 = (new Graph('mygraph', {needFocus: true, animate: true, mouseMove: true, zoom: 10})).add(
        function(p, res) {
          var k = -10*(p.u - 0.1*p.ct);
          res.pt.x = p.v * p.mx * Math.cos((p.cx+10)/20*(k));
          res.pt.y = p.v * p.my * Math.sin((p.cy+3)/20*(k));
          var r = ((1+Math.sin(k/10))*4)<<5,
              g = ((1+Math.sin(k/30))*4)<<5,
              b = ((1+ Math.sin(k/5))*4)<<5;
          res.color = UI.rgbStr(r,g,b);
          return res;
        },{uP: {step: 0.02}, vP: {step: 1, max: 2}});

        (new Graph('another', {mouseClick: true})).add(
        function(p, res) {
          var k = -10*(p.u - 0.1*p.ct);
          res.pt.x = p.v * 10 * Math.cos((p.cx+10)/20*(k));
          res.pt.y = p.v * 10 * Math.sin((p.cy+3)/20*(k));
          var r = ((1+Math.sin(k/10))*4)<<5,
              g = ((1+Math.sin(k/30))*4)<<5,
              b = ((1+ Math.sin(k/5))*4)<<5;
          res.color = UI.rgbStr(r,g,b);
          return res;
        },{uP: {step: 0.02}, vP: {step: 1, max: 2}});

        
        function PointHolder() {
          var x = [], y = [];
          for (var i = 0; i < 10; i++) {
            x[i] = 40 * Math.random() - 20;
            y[i] = 40 * Math.random() - 20;
          }
          this.pt = function(p, res) {
            res.pt.x = x[p.u];
            res.pt.y = y[p.u];
            dist = Math.sqrt(Math.pow(p.mx - res.pt.x,2) +
              Math.pow(p.my - res.pt.y, 2));
            res.color = dist < 5 ? 'red': 'orange';
            return res;
          };
        }
        var hank = new PointHolder();
        (new Graph('points', {mouseMove: true})).add(
        function(p, res) {
          res.pt.x = 40 * Math.random() - 20;
          res.pt.y = 40 * Math.random() - 20;
          return res;
        },'crosses').add(
        hank.pt, {uP: {min: 0, max: 10, step: 1}, color: 'green', size: 5, dType: 'points'});

        function PointHolder2() {
          var x = [], y = [];
          for (var i = 0; i < 10; i++) {
            x[i] = 40 * Math.random() - 20;
            y[i] = 40 * Math.random() - 20;
          }
          this.pt = function(p, res) {
            res.pt.x = x[p.u];
            res.pt.y = y[p.u];
            res.s = 1/Math.sqrt(Math.pow(p.cx - res.pt.x,2) +
              Math.pow(p.cy - res.pt.y, 2));
            res.color = p.win && p.wu === p.u ? 'red': 'orange';
            return res;
          };
        }
        var honk = new PointHolder2();
        var cross = new PointHolder2();
        (new Graph('morePoints', {zoom: 30, mouseClick: true})).add(
        honk.pt, {uMax: 10, color: 'green', type: 'crosses'}).add(
        function(p){
          return {text: p.u.toFixed(0), pt: {x: 0, y: p.u}};
        }, {uStep: 1, uMax: 10, color: 'green', size: 12, dType: 'text'}).add(
        cross.pt, {uMin: 0, uMax: 10, uStep: 1, color: 'green', size: 5, type: 'points'}).add(
        function(p,res){return{pt:{x:p.u, y:p.u*p.u}};}, 'yOfx');



        function PointHolder3() {
          var x = [], y = [];
          for (var i = 0; i < 10; i++) {
            x[i] = 40 * Math.random() - 20;
            y[i] = 40 * Math.random() - 20;
          }
          this.pt = function(p, res) {
            res.pt.x = x[p.u];
            res.pt.y = y[p.u];
            res.s = 100-Math.sqrt(Math.pow(p.mx - res.pt.x,2) +
            Math.pow(p.my - res.pt.y, 2));
            if( p.md && p.win && p.wu === p.u ) {
              x[p.u] = p.mx;
              y[p.u] = p.my;
            }
            res.color = p.win && p.wu === p.u ? 'red': 'orange';
            return res;
          };
        }
        var draggy = new PointHolder3();
        (new Graph('draggy', {mouseMove: true, mouseClick: true, zoom: 10})).add(
        draggy.pt, {uP: {min: 0, max: 10, step: 1}, color: 'green', size: 5, type: 'points'});

        function PointHolder4() {
          var x = [], y = [];
          for (var i = 0; i < 10; i++) {
            x[i] = 40 * Math.random() - 20;
            y[i] = 40 * Math.random() - 20;
          }
          this.pt = function(p, res) {
            res.pt.x = x[p.u] - p.tmdx - p.cmdx;
            res.pt.y = y[p.u] - p.tmdy - p.cmdy;
            res.color = p.win && p.wu === p.u ? 'red': 'orange';
            return res;
          };
        }
        var panny = new PointHolder4();
        (new Graph('panny', {mouseMove: true, mouseClick: true, zoom: 10})).add(
        panny.pt, 'points');

      </script>
    </body>
</html>
